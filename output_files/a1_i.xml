<?xml version="1.0" encoding="utf-8"?>
        <!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'><nta>
  <declaration>const int __d_vals_at_id6__id3__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id5__id3__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id6__id2__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id4__id3__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id5__id2__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id6__id0__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id4__id2__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id5__id0__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id4__id0__l978zmp3[1][2] = {{0,0}};
const int __d_vals_at_id4__id1__l978zmp3[8][2] = {{0,0},{0,1},{0,2},{0,3},{1,0},{1,1},{1,2},{1,3}};
// Place global declarations here.
const int N_V = 1;
const int N_C = 3;

chan decl[N_V+1];
chan coll[N_V+1];
chan vote[N_V+1];
//int[0,N_V] tally[N_C+1];

int[0,2] sh_dec; // 1 - inperson, 2 - by mail
int[0,1] buff_mail[N_V+1]; // election package is delivered to mailbox
int[0,N_C] sh_vt; // chosen candidate
int[0,1] sh_sg; // signed form (honest+private casting)

//int ballots_received(){
//    int i;
//	int res=0;
//	if(tally_sum!=0)return tally_sum;
//    return tally_1+tally_2+tally_3;
//}
</declaration>
  <template>
    <name x="5" y="5">ExtendedMAS</name>
    <declaration>// From Authority:
int [ 0, 2 ] Authority_dec_recv [ N_V + 1 ]; int [ 0, 1 ] Authority_pack_sent [ N_V + 1 ]; int [ 0, N_C ] Authority_vt_recv [ N_V + 1 ]; int [ 0, 1 ] Authority_sg_recv [ N_V + 1 ]; int [ 0, N_V ] Authority_tally_1, Authority_tally_2, Authority_tally_3; int Authority_tally_sum;
// From Voter_1:
const int Voter_1_id = 1;
int [ 0, 2 ] Voter_1_mem_dec; int [ 0, 1 ] Voter_1_mem_sg; int [ 0, N_C ] Voter_1_mem_vt;

void _set_argsr_values__l978zmp3(int _val_of_Voter_1_mem_sg, int _val_of_Voter_1_mem_vt){
	Voter_1_mem_sg= _val_of_Voter_1_mem_sg;
	Voter_1_mem_vt= _val_of_Voter_1_mem_vt;
}
void _update_argsn_values__l978zmp3(){
	
}</declaration>
    <location id="id6__id3">
      <name>id6__id3</name>
    </location>
    <location id="id5__id3">
      <name>id5__id3</name>
    </location>
    <location id="id6__id2">
      <name>id6__id2</name>
    </location>
    <location id="id4__id3">
      <name>id4__id3</name>
    </location>
    <location id="id5__id2">
      <name>id5__id2</name>
    </location>
    <location id="id6__id0">
      <name>id6__id0</name>
    </location>
    <location id="id4__id2">
      <name>id4__id2</name>
    </location>
    <location id="id5__id0">
      <name>id5__id0</name>
    </location>
    <location id="id4__id0">
      <name>id4__id0</name>
    </location>
    <location id="id4__id1">
      <name>id4__id1</name>
    </location>
    <init ref="id6__id3"/>
    <transition>
      <source ref="id6__id3"/>
      <target ref="id5__id3"/>
    </transition>
    <transition>
      <source ref="id6__id3"/>
      <target ref="id6__id2"/>
      <label kind="select">inperson:int[1,2],
v_i:int[1,N_V],
_l978zmp3:int[0,0]</label>
      <label kind="guard">Voter_1_id==v_i</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id6__id3__l978zmp3[_l978zmp3][0],__d_vals_at_id6__id3__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
Voter_1_mem_dec=inperson,
sh_dec=inperson,
Authority_dec_recv[v_i]=sh_dec,
sh_dec=0,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id3"/>
      <target ref="id5__id3"/>
      <label kind="select">v_i:int[1,N_V],
_l978zmp3:int[0,0]</label>
      <label kind="guard">Authority_dec_recv [ v_i ] == 2 &amp;&amp; Authority_pack_sent [ v_i ] == 0</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id5__id3__l978zmp3[_l978zmp3][0],__d_vals_at_id5__id3__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
buff_mail[v_i]=1,
Authority_pack_sent[v_i]+=1,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id3"/>
      <target ref="id4__id3"/>
    </transition>
    <transition>
      <source ref="id6__id2"/>
      <target ref="id5__id2"/>
    </transition>
    <transition>
      <source ref="id6__id2"/>
      <target ref="id6__id0"/>
      <label kind="select">_l978zmp3:int[0,0]</label>
      <label kind="guard">Voter_1_mem_dec == 2 &amp;&amp; buff_mail [ Voter_1_id ] == 1</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id6__id2__l978zmp3[_l978zmp3][0],__d_vals_at_id6__id2__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
buff_mail[Voter_1_id]=0,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id2"/>
      <target ref="id5__id2"/>
      <label kind="select">v_i:int[1,N_V],
_l978zmp3:int[0,0]</label>
      <label kind="guard">Authority_dec_recv [ v_i ] == 2 &amp;&amp; Authority_pack_sent [ v_i ] == 0</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id5__id2__l978zmp3[_l978zmp3][0],__d_vals_at_id5__id2__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
buff_mail[v_i]=1,
Authority_pack_sent[v_i]+=1,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id2"/>
      <target ref="id4__id2"/>
    </transition>
    <transition>
      <source ref="id5__id2"/>
      <target ref="id5__id0"/>
      <label kind="select">_l978zmp3:int[0,0]</label>
      <label kind="guard">Voter_1_mem_dec == 2 &amp;&amp; buff_mail [ Voter_1_id ] == 1</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id5__id2__l978zmp3[_l978zmp3][0],__d_vals_at_id5__id2__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
buff_mail[Voter_1_id]=0,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id2"/>
      <target ref="id5__id0"/>
      <label kind="select">v_i:int[1,N_V],
_l978zmp3:int[0,0]</label>
      <label kind="guard">Voter_1_id==v_i &amp;&amp; Voter_1_mem_dec == 1 &amp;&amp; Authority_dec_recv [ v_i ] == 1 &amp;&amp; Authority_pack_sent [ v_i ] == 0</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id5__id2__l978zmp3[_l978zmp3][0],__d_vals_at_id5__id2__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
Authority_pack_sent[v_i]+=1,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id6__id0"/>
      <target ref="id5__id0"/>
    </transition>
    <transition>
      <source ref="id4__id2"/>
      <target ref="id4__id0"/>
      <label kind="select">_l978zmp3:int[0,0]</label>
      <label kind="guard">Voter_1_mem_dec == 2 &amp;&amp; buff_mail [ Voter_1_id ] == 1</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id4__id2__l978zmp3[_l978zmp3][0],__d_vals_at_id4__id2__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
buff_mail[Voter_1_id]=0,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id0"/>
      <target ref="id5__id0"/>
      <label kind="select">v_i:int[1,N_V],
_l978zmp3:int[0,0]</label>
      <label kind="guard">Authority_dec_recv [ v_i ] == 2 &amp;&amp; Authority_pack_sent [ v_i ] == 0</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id5__id0__l978zmp3[_l978zmp3][0],__d_vals_at_id5__id0__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
buff_mail[v_i]=1,
Authority_pack_sent[v_i]+=1,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
    <transition>
      <source ref="id5__id0"/>
      <target ref="id4__id0"/>
    </transition>
    <transition>
      <source ref="id4__id0"/>
      <target ref="id4__id1"/>
      <label kind="select">vt:int[0,N_C],
sg:int[0,1],
v_i:int[1,N_V],
_l978zmp3:int[0,0]</label>
      <label kind="guard">Voter_1_id==v_i</label>
      <label kind="assignment">_set_argsr_values__l978zmp3(__d_vals_at_id4__id0__l978zmp3[_l978zmp3][0],__d_vals_at_id4__id0__l978zmp3[_l978zmp3][1]),
_update_argsn_values__l978zmp3(),
sh_vt=vt,
sh_sg=sg,
Voter_1_mem_sg=sg,
Voter_1_mem_vt=vt,
Authority_tally_1=(sh_sg&amp;&amp;sh_vt==1)?(Authority_tally_1+1):Authority_tally_1,
Authority_tally_2=(sh_sg&amp;&amp;sh_vt==2)?(Authority_tally_2+1):Authority_tally_2,
Authority_tally_3=(sh_sg&amp;&amp;sh_vt==3)?(Authority_tally_3+1):Authority_tally_3,
sh_vt=0,
sh_sg=0,
_update_argsn_values__l978zmp3(),
_set_argsr_values__l978zmp3(0,0)</label>
    </transition>
  </template>
  <system>// Place template instantiations here.
Process = ExtendedMAS();
// List one or more processes to be composed into a system.
system Process;
    </system>
  <queries>
    <query>
      <formula></formula>
      <comment></comment>
    </query>
  </queries>
</nta>